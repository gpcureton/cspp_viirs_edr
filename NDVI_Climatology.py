#!/usr/bin/env python
# encoding: utf-8
"""
NDVI_Climatology.py

Purpose: This script will compute the min and max global gridded NDVI from the 
         16-day NDVI 
         
         The Filled Normalized Difference Vegetative Index (NDVI)
         Product, which is computed from the (White-Sky) Filled Land Surface
         Albedo Map Product, is a global data set of spatially complete NDVI
         maps for 23 sixteen-day periods per year (001, 017, ... 353). There are
         two types of Filled NDVI Products: 1-minute Map Products and coarser
         resolution Statistical Products.

         Map Products, containing spatially complete NDVI data, are generated at
         1-minute resolution on an equal-angle grid.

Input:
    * Various inputs.

Output:
    * None

Details:
    * None

Preconditions:
    * None

Optional:
    * 

Minimum commandline:

    python NDVI_Climatology.py  [mandatory options]


Created by Geoff Cureton <geoff.cureton@ssec.wisc.edu> on 2014-04-30.
Copyright (c) 2014 University of Wisconsin Regents. All rights reserved.

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
"""

file_Date = '$Date$'
file_Revision = '$Revision$'
file_Author = '$Author$'
file_HeadURL = '$HeadURL$'
file_Id = '$Id$'

__author__ = 'Geoff Cureton <geoff.cureton@ssec.wisc.edu>'
__version__ = '$Id$'
__docformat__ = 'Epytext'

import os
from os import path,uname,environ
import sys
import logging
import traceback
import string
import re
import uuid
from shutil import rmtree,copyfile
from glob import glob
import copy
from time import time
from datetime import datetime,timedelta

import numpy as np
from numpy import ma

import tables as pytables
import h5py

import matplotlib
import matplotlib.cm as cm
from matplotlib.colors import Colormap, normalize, LinearSegmentedColormap,ListedColormap

from matplotlib.figure import Figure

matplotlib.use('Agg')
from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas

# This must come *after* the backend is specified.
import matplotlib.pyplot as ppl
from mpl_toolkits.basemap import Basemap,addcyclic,shiftgrid

# every module should have a LOG object
LOG = logging.getLogger(__file__)

ndvi_cmdata = {
        'blue': [ (0.0, 0.92156862745098034, 0.92156862745098034),
                  (0.0039215686274509803, 0.92156862745098034, 0.92156862745098034),
                  (0.0078431372549019607, 0.92156862745098034, 0.92156862745098034),
                  (0.011764705882352941, 0.92156862745098034, 0.92156862745098034),
                  (0.015686274509803921, 0.92156862745098034, 0.92156862745098034),
                  (0.019607843137254902, 0.92156862745098034, 0.92156862745098034),
                  (0.023529411764705882, 0.92156862745098034, 0.92156862745098034),
                  (0.027450980392156862, 0.92156862745098034, 0.92156862745098034),
                  (0.031372549019607843, 0.92156862745098034, 0.92156862745098034),
                  (0.035294117647058823, 0.92156862745098034, 0.92156862745098034),
                  (0.039215686274509803, 0.92156862745098034, 0.92156862745098034),
                  (0.043137254901960784, 0.92156862745098034, 0.92156862745098034),
                  (0.047058823529411764, 0.92156862745098034, 0.92156862745098034),
                  (0.050980392156862744, 0.92156862745098034, 0.92156862745098034),
                  (0.054901960784313725, 0.92156862745098034, 0.92156862745098034),
                  (0.058823529411764705, 0.92156862745098034, 0.92156862745098034),
                  (0.062745098039215685, 0.12549019607843137, 0.12549019607843137),
                  (0.066666666666666666, 0.13333333333333333, 0.13333333333333333),
                  (0.070588235294117646, 0.14117647058823529, 0.14117647058823529),
                  (0.074509803921568626, 0.14901960784313725, 0.14901960784313725),
                  (0.078431372549019607, 0.15294117647058825, 0.15294117647058825),
                  (0.082352941176470587, 0.16078431372549021, 0.16078431372549021),
                  (0.086274509803921567, 0.16862745098039217, 0.16862745098039217),
                  (0.090196078431372548, 0.17647058823529413, 0.17647058823529413),
                  (0.094117647058823528, 0.18431372549019609, 0.18431372549019609),
                  (0.098039215686274508, 0.19215686274509805, 0.19215686274509805),
                  (0.10196078431372549, 0.19607843137254902, 0.19607843137254902),
                  (0.10588235294117647, 0.20392156862745098, 0.20392156862745098),
                  (0.10980392156862745, 0.21176470588235294, 0.21176470588235294),
                  (0.11372549019607843, 0.2196078431372549, 0.2196078431372549),
                  (0.11764705882352941, 0.22745098039215686, 0.22745098039215686),
                  (0.12156862745098039, 0.23137254901960785, 0.23137254901960785),
                  (0.12549019607843137, 0.23921568627450981, 0.23921568627450981),
                  (0.12941176470588237, 0.24705882352941178, 0.24705882352941178),
                  (0.13333333333333333, 0.25098039215686274, 0.25098039215686274),
                  (0.13725490196078433, 0.25882352941176473, 0.25882352941176473),
                  (0.14117647058823529, 0.2627450980392157, 0.2627450980392157),
                  (0.14509803921568629, 0.27058823529411763, 0.27058823529411763),
                  (0.14901960784313725, 0.27843137254901962, 0.27843137254901962),
                  (0.15294117647058825, 0.28235294117647058, 0.28235294117647058),
                  (0.15686274509803921, 0.29019607843137257, 0.29019607843137257),
                  (0.16078431372549021, 0.29411764705882354, 0.29411764705882354),
                  (0.16470588235294117, 0.29803921568627451, 0.29803921568627451),
                  (0.16862745098039217, 0.30588235294117649, 0.30588235294117649),
                  (0.17254901960784313, 0.30980392156862746, 0.30980392156862746),
                  (0.17647058823529413, 0.31764705882352939, 0.31764705882352939),
                  (0.1803921568627451, 0.32156862745098042, 0.32156862745098042),
                  (0.18431372549019609, 0.32549019607843138, 0.32549019607843138),
                  (0.18823529411764706, 0.33333333333333331, 0.33333333333333331),
                  (0.19215686274509805, 0.33725490196078434, 0.33725490196078434),
                  (0.19607843137254902, 0.3411764705882353, 0.3411764705882353),
                  (0.20000000000000001, 0.34509803921568627, 0.34509803921568627),
                  (0.20392156862745098, 0.34901960784313724, 0.34901960784313724),
                  (0.20784313725490197, 0.35294117647058826, 0.35294117647058826),
                  (0.21176470588235294, 0.35686274509803922, 0.35686274509803922),
                  (0.21568627450980393, 0.36078431372549019, 0.36078431372549019),
                  (0.2196078431372549, 0.36470588235294116, 0.36470588235294116),
                  (0.22352941176470589, 0.36862745098039218, 0.36862745098039218),
                  (0.22745098039215686, 0.37254901960784315, 0.37254901960784315),
                  (0.23137254901960785, 0.37647058823529411, 0.37647058823529411),
                  (0.23529411764705882, 0.38039215686274508, 0.38039215686274508),
                  (0.23921568627450981, 0.3843137254901961, 0.3843137254901961),
                  (0.24313725490196078, 0.38823529411764707, 0.38823529411764707),
                  (0.24705882352941178, 0.38823529411764707, 0.38823529411764707),
                  (0.25098039215686274, 0.39215686274509803, 0.39215686274509803),
                  (0.25490196078431371, 0.396078431372549, 0.396078431372549),
                  (0.25882352941176473, 0.396078431372549, 0.396078431372549),
                  (0.2627450980392157, 0.40000000000000002, 0.40000000000000002),
                  (0.26666666666666666, 0.40000000000000002, 0.40000000000000002),
                  (0.27058823529411763, 0.40392156862745099, 0.40392156862745099),
                  (0.27450980392156865, 0.40392156862745099, 0.40392156862745099),
                  (0.27843137254901962, 0.40392156862745099, 0.40392156862745099),
                  (0.28235294117647058, 0.40784313725490196, 0.40784313725490196),
                  (0.28627450980392155, 0.40784313725490196, 0.40784313725490196),
                  (0.29019607843137257, 0.40784313725490196, 0.40784313725490196),
                  (0.29411764705882354, 0.17254901960784313, 0.17254901960784313),
                  (0.29803921568627451, 0.17254901960784313, 0.17254901960784313),
                  (0.30196078431372547, 0.17254901960784313, 0.17254901960784313),
                  (0.30588235294117649, 0.17254901960784313, 0.17254901960784313),
                  (0.30980392156862746, 0.17254901960784313, 0.17254901960784313),
                  (0.31372549019607843, 0.17254901960784313, 0.17254901960784313),
                  (0.31764705882352939, 0.17254901960784313, 0.17254901960784313),
                  (0.32156862745098042, 0.17254901960784313, 0.17254901960784313),
                  (0.32549019607843138, 0.17254901960784313, 0.17254901960784313),
                  (0.32941176470588235, 0.17254901960784313, 0.17254901960784313),
                  (0.33333333333333331, 0.17254901960784313, 0.17254901960784313),
                  (0.33725490196078434, 0.17254901960784313, 0.17254901960784313),
                  (0.3411764705882353, 0.17254901960784313, 0.17254901960784313),
                  (0.34509803921568627, 0.17254901960784313, 0.17254901960784313),
                  (0.34901960784313724, 0.17254901960784313, 0.17254901960784313),
                  (0.35294117647058826, 0.074509803921568626, 0.074509803921568626),
                  (0.35686274509803922, 0.074509803921568626, 0.074509803921568626),
                  (0.36078431372549019, 0.074509803921568626, 0.074509803921568626),
                  (0.36470588235294116, 0.074509803921568626, 0.074509803921568626),
                  (0.36862745098039218, 0.074509803921568626, 0.074509803921568626),
                  (0.37254901960784315, 0.074509803921568626, 0.074509803921568626),
                  (0.37647058823529411, 0.074509803921568626, 0.074509803921568626),
                  (0.38039215686274508, 0.074509803921568626, 0.074509803921568626),
                  (0.3843137254901961, 0.074509803921568626, 0.074509803921568626),
                  (0.38823529411764707, 0.074509803921568626, 0.074509803921568626),
                  (0.39215686274509803, 0.074509803921568626, 0.074509803921568626),
                  (0.396078431372549, 0.074509803921568626, 0.074509803921568626),
                  (0.40000000000000002, 0.074509803921568626, 0.074509803921568626),
                  (0.40392156862745099, 0.074509803921568626, 0.074509803921568626),
                  (0.40784313725490196, 0.074509803921568626, 0.074509803921568626),
                  (0.41176470588235292, 0.0, 0.0),
                  (0.41568627450980394, 0.0, 0.0),
                  (0.41960784313725491, 0.0, 0.0),
                  (0.42352941176470588, 0.0, 0.0),
                  (0.42745098039215684, 0.0, 0.0),
                  (0.43137254901960786, 0.0, 0.0),
                  (0.43529411764705883, 0.0, 0.0),
                  (0.4392156862745098, 0.0, 0.0),
                  (0.44313725490196076, 0.0, 0.0),
                  (0.44705882352941179, 0.0, 0.0),
                  (0.45098039215686275, 0.0, 0.0),
                  (0.45490196078431372, 0.0, 0.0),
                  (0.45882352941176469, 0.0, 0.0),
                  (0.46274509803921571, 0.0, 0.0),
                  (0.46666666666666667, 0.0, 0.0),
                  (0.47058823529411764, 0.0, 0.0),
                  (0.47450980392156861, 0.0, 0.0),
                  (0.47843137254901963, 0.0, 0.0),
                  (0.4823529411764706, 0.0, 0.0),
                  (0.48627450980392156, 0.0, 0.0),
                  (0.49019607843137253, 0.0, 0.0),
                  (0.49411764705882355, 0.0, 0.0),
                  (0.49803921568627452, 0.0, 0.0),
                  (0.50196078431372548, 0.0, 0.0),
                  (0.50588235294117645, 0.0, 0.0),
                  (0.50980392156862742, 0.0, 0.0),
                  (0.51372549019607838, 0.0, 0.0),
                  (0.51764705882352946, 0.0, 0.0),
                  (0.52156862745098043, 0.0, 0.0),
                  (0.52549019607843139, 0.0, 0.0),
                  (0.52941176470588236, 0.0, 0.0),
                  (0.53333333333333333, 0.0, 0.0),
                  (0.53725490196078429, 0.0, 0.0),
                  (0.54117647058823526, 0.0, 0.0),
                  (0.54509803921568623, 0.0, 0.0),
                  (0.5490196078431373, 0.0, 0.0),
                  (0.55294117647058827, 0.0, 0.0),
                  (0.55686274509803924, 0.0, 0.0),
                  (0.5607843137254902, 0.0, 0.0),
                  (0.56470588235294117, 0.0, 0.0),
                  (0.56862745098039214, 0.0, 0.0),
                  (0.5725490196078431, 0.0, 0.0),
                  (0.57647058823529407, 0.0, 0.0),
                  (0.58039215686274515, 0.0, 0.0),
                  (0.58431372549019611, 0.0, 0.0),
                  (0.58823529411764708, 0.0039215686274509803, 0.0039215686274509803),
                  (0.59215686274509804, 0.0039215686274509803, 0.0039215686274509803),
                  (0.59607843137254901, 0.0039215686274509803, 0.0039215686274509803),
                  (0.59999999999999998, 0.0039215686274509803, 0.0039215686274509803),
                  (0.60392156862745094, 0.0039215686274509803, 0.0039215686274509803),
                  (0.60784313725490191, 0.0039215686274509803, 0.0039215686274509803),
                  (0.61176470588235299, 0.0039215686274509803, 0.0039215686274509803),
                  (0.61568627450980395, 0.0039215686274509803, 0.0039215686274509803),
                  (0.61960784313725492, 0.0039215686274509803, 0.0039215686274509803),
                  (0.62352941176470589, 0.0039215686274509803, 0.0039215686274509803),
                  (0.62745098039215685, 0.0039215686274509803, 0.0039215686274509803),
                  (0.63137254901960782, 0.0039215686274509803, 0.0039215686274509803),
                  (0.63529411764705879, 0.0039215686274509803, 0.0039215686274509803),
                  (0.63921568627450975, 0.0039215686274509803, 0.0039215686274509803),
                  (0.64313725490196083, 0.0039215686274509803, 0.0039215686274509803),
                  (0.6470588235294118, 0.0039215686274509803, 0.0039215686274509803),
                  (0.65098039215686276, 0.0039215686274509803, 0.0039215686274509803),
                  (0.65490196078431373, 0.0039215686274509803, 0.0039215686274509803),
                  (0.6588235294117647, 0.0039215686274509803, 0.0039215686274509803),
                  (0.66274509803921566, 0.0039215686274509803, 0.0039215686274509803),
                  (0.66666666666666663, 0.0039215686274509803, 0.0039215686274509803),
                  (0.6705882352941176, 0.0039215686274509803, 0.0039215686274509803),
                  (0.67450980392156867, 0.0039215686274509803, 0.0039215686274509803),
                  (0.67843137254901964, 0.0039215686274509803, 0.0039215686274509803),
                  (0.68235294117647061, 0.0039215686274509803, 0.0039215686274509803),
                  (0.68627450980392157, 0.0039215686274509803, 0.0039215686274509803),
                  (0.69019607843137254, 0.0039215686274509803, 0.0039215686274509803),
                  (0.69411764705882351, 0.0039215686274509803, 0.0039215686274509803),
                  (0.69803921568627447, 0.0039215686274509803, 0.0039215686274509803),
                  (0.70196078431372544, 0.0039215686274509803, 0.0039215686274509803),
                  (0.70588235294117652, 0.0039215686274509803, 0.0039215686274509803),
                  (0.70980392156862748, 0.0039215686274509803, 0.0039215686274509803),
                  (0.71372549019607845, 0.0039215686274509803, 0.0039215686274509803),
                  (0.71764705882352942, 0.0039215686274509803, 0.0039215686274509803),
                  (0.72156862745098038, 0.0039215686274509803, 0.0039215686274509803),
                  (0.72549019607843135, 0.0039215686274509803, 0.0039215686274509803),
                  (0.72941176470588232, 0.0039215686274509803, 0.0039215686274509803),
                  (0.73333333333333328, 0.0039215686274509803, 0.0039215686274509803),
                  (0.73725490196078436, 0.0039215686274509803, 0.0039215686274509803),
                  (0.74117647058823533, 0.0039215686274509803, 0.0039215686274509803),
                  (0.74509803921568629, 0.0039215686274509803, 0.0039215686274509803),
                  (0.74901960784313726, 0.0039215686274509803, 0.0039215686274509803),
                  (0.75294117647058822, 0.0039215686274509803, 0.0039215686274509803),
                  (0.75686274509803919, 0.0039215686274509803, 0.0039215686274509803),
                  (0.76078431372549016, 0.0039215686274509803, 0.0039215686274509803),
                  (0.76470588235294112, 0.0, 0.0),
                  (0.7686274509803922, 0.0, 0.0),
                  (0.77254901960784317, 0.0, 0.0),
                  (0.77647058823529413, 0.0, 0.0),
                  (0.7803921568627451, 0.0, 0.0),
                  (0.78431372549019607, 0.0, 0.0),
                  (0.78823529411764703, 0.0, 0.0),
                  (0.792156862745098, 0.0, 0.0),
                  (0.79607843137254897, 0.0, 0.0),
                  (0.80000000000000004, 0.0, 0.0),
                  (0.80392156862745101, 0.0, 0.0),
                  (0.80784313725490198, 0.0, 0.0),
                  (0.81176470588235294, 0.0, 0.0),
                  (0.81568627450980391, 0.0, 0.0),
                  (0.81960784313725488, 0.0, 0.0),
                  (0.82352941176470584, 0.0039215686274509803, 0.0039215686274509803),
                  (0.82745098039215681, 0.0039215686274509803, 0.0039215686274509803),
                  (0.83137254901960789, 0.0039215686274509803, 0.0039215686274509803),
                  (0.83529411764705885, 0.0039215686274509803, 0.0039215686274509803),
                  (0.83921568627450982, 0.0039215686274509803, 0.0039215686274509803),
                  (0.84313725490196079, 0.0039215686274509803, 0.0039215686274509803),
                  (0.84705882352941175, 0.0039215686274509803, 0.0039215686274509803),
                  (0.85098039215686272, 0.0039215686274509803, 0.0039215686274509803),
                  (0.85490196078431369, 0.0039215686274509803, 0.0039215686274509803),
                  (0.85882352941176465, 0.0039215686274509803, 0.0039215686274509803),
                  (0.86274509803921573, 0.0039215686274509803, 0.0039215686274509803),
                  (0.8666666666666667, 0.0039215686274509803, 0.0039215686274509803),
                  (0.87058823529411766, 0.0039215686274509803, 0.0039215686274509803),
                  (0.87450980392156863, 0.0039215686274509803, 0.0039215686274509803),
                  (0.8784313725490196, 0.0039215686274509803, 0.0039215686274509803),
                  (0.88235294117647056, 0.0039215686274509803, 0.0039215686274509803),
                  (0.88627450980392153, 0.0039215686274509803, 0.0039215686274509803),
                  (0.8901960784313725, 0.0039215686274509803, 0.0039215686274509803),
                  (0.89411764705882357, 0.0039215686274509803, 0.0039215686274509803),
                  (0.89803921568627454, 0.0039215686274509803, 0.0039215686274509803),
                  (0.90196078431372551, 0.0039215686274509803, 0.0039215686274509803),
                  (0.90588235294117647, 0.0039215686274509803, 0.0039215686274509803),
                  (0.90980392156862744, 0.0039215686274509803, 0.0039215686274509803),
                  (0.9137254901960784, 0.0039215686274509803, 0.0039215686274509803),
                  (0.91764705882352937, 0.0039215686274509803, 0.0039215686274509803),
                  (0.92156862745098034, 0.0039215686274509803, 0.0039215686274509803),
                  (0.92549019607843142, 0.0039215686274509803, 0.0039215686274509803),
                  (0.92941176470588238, 0.0039215686274509803, 0.0039215686274509803),
                  (0.93333333333333335, 0.0039215686274509803, 0.0039215686274509803),
                  (0.93725490196078431, 0.0039215686274509803, 0.0039215686274509803),
                  (0.94117647058823528, 0.0039215686274509803, 0.0039215686274509803),
                  (0.94509803921568625, 0.0039215686274509803, 0.0039215686274509803),
                  (0.94901960784313721, 0.0039215686274509803, 0.0039215686274509803),
                  (0.95294117647058818, 0.0039215686274509803, 0.0039215686274509803),
                  (0.95686274509803926, 0.0039215686274509803, 0.0039215686274509803),
                  (0.96078431372549022, 0.0039215686274509803, 0.0039215686274509803),
                  (0.96470588235294119, 0.0039215686274509803, 0.0039215686274509803),
                  (0.96862745098039216, 0.0039215686274509803, 0.0039215686274509803),
                  (0.97254901960784312, 0.0039215686274509803, 0.0039215686274509803),
                  (0.97647058823529409, 0.0039215686274509803, 0.0039215686274509803),
                  (0.98039215686274506, 0.0039215686274509803, 0.0039215686274509803),
                  (0.98431372549019602, 0.0039215686274509803, 0.0039215686274509803),
                  (0.9882352941176471, 0.0039215686274509803, 0.0039215686274509803),
                  (0.99215686274509807, 0.0039215686274509803, 0.0039215686274509803),
                  (0.99607843137254903, 0.0039215686274509803, 0.0039215686274509803),
                  (1.0, 0.0039215686274509803, 0.0039215686274509803)],

        'green': [(0.0, 0.92156862745098034, 0.92156862745098034),
                  (0.0039215686274509803, 0.92156862745098034, 0.92156862745098034),
                  (0.0078431372549019607, 0.92156862745098034, 0.92156862745098034),
                  (0.011764705882352941, 0.92156862745098034, 0.92156862745098034),
                  (0.015686274509803921, 0.92156862745098034, 0.92156862745098034),
                  (0.019607843137254902, 0.92156862745098034, 0.92156862745098034),
                  (0.023529411764705882, 0.92156862745098034, 0.92156862745098034),
                  (0.027450980392156862, 0.92156862745098034, 0.92156862745098034),
                  (0.031372549019607843, 0.92156862745098034, 0.92156862745098034),
                  (0.035294117647058823, 0.92156862745098034, 0.92156862745098034),
                  (0.039215686274509803, 0.92156862745098034, 0.92156862745098034),
                  (0.043137254901960784, 0.92156862745098034, 0.92156862745098034),
                  (0.047058823529411764, 0.92156862745098034, 0.92156862745098034),
                  (0.050980392156862744, 0.92156862745098034, 0.92156862745098034),
                  (0.054901960784313725, 0.92156862745098034, 0.92156862745098034),
                  (0.058823529411764705, 0.92156862745098034, 0.92156862745098034),
                  (0.062745098039215685, 0.42352941176470588, 0.42352941176470588),
                  (0.066666666666666666, 0.43137254901960786, 0.43137254901960786),
                  (0.070588235294117646, 0.44313725490196076, 0.44313725490196076),
                  (0.074509803921568626, 0.45098039215686275, 0.45098039215686275),
                  (0.078431372549019607, 0.46274509803921571, 0.46274509803921571),
                  (0.082352941176470587, 0.47058823529411764, 0.47058823529411764),
                  (0.086274509803921567, 0.4823529411764706, 0.4823529411764706),
                  (0.090196078431372548, 0.49019607843137253, 0.49019607843137253),
                  (0.094117647058823528, 0.50196078431372548, 0.50196078431372548),
                  (0.098039215686274508, 0.50980392156862742, 0.50980392156862742),
                  (0.10196078431372549, 0.52156862745098043, 0.52156862745098043),
                  (0.10588235294117647, 0.52941176470588236, 0.52941176470588236),
                  (0.10980392156862745, 0.53725490196078429, 0.53725490196078429),
                  (0.11372549019607843, 0.5490196078431373, 0.5490196078431373),
                  (0.11764705882352941, 0.55686274509803924, 0.55686274509803924),
                  (0.12156862745098039, 0.56470588235294117, 0.56470588235294117),
                  (0.12549019607843137, 0.57647058823529407, 0.57647058823529407),
                  (0.12941176470588237, 0.58431372549019611, 0.58431372549019611),
                  (0.13333333333333333, 0.59215686274509804, 0.59215686274509804),
                  (0.13725490196078433, 0.60392156862745094, 0.60392156862745094),
                  (0.14117647058823529, 0.61176470588235299, 0.61176470588235299),
                  (0.14509803921568629, 0.61960784313725492, 0.61960784313725492),
                  (0.14901960784313725, 0.62745098039215685, 0.62745098039215685),
                  (0.15294117647058825, 0.63529411764705879, 0.63529411764705879),
                  (0.15686274509803921, 0.6470588235294118, 0.6470588235294118),
                  (0.16078431372549021, 0.65490196078431373, 0.65490196078431373),
                  (0.16470588235294117, 0.66274509803921566, 0.66274509803921566),
                  (0.16862745098039217, 0.6705882352941176, 0.6705882352941176),
                  (0.17254901960784313, 0.67843137254901964, 0.67843137254901964),
                  (0.17647058823529413, 0.68627450980392157, 0.68627450980392157),
                  (0.1803921568627451, 0.69411764705882351, 0.69411764705882351),
                  (0.18431372549019609, 0.70196078431372544, 0.70196078431372544),
                  (0.18823529411764706, 0.70980392156862748, 0.70980392156862748),
                  (0.19215686274509805, 0.71764705882352942, 0.71764705882352942),
                  (0.19607843137254902, 0.72549019607843135, 0.72549019607843135),
                  (0.20000000000000001, 0.73333333333333328, 0.73333333333333328),
                  (0.20392156862745098, 0.74117647058823533, 0.74117647058823533),
                  (0.20784313725490197, 0.74901960784313726, 0.74901960784313726),
                  (0.21176470588235294, 0.75294117647058822, 0.75294117647058822),
                  (0.21568627450980393, 0.76078431372549016, 0.76078431372549016),
                  (0.2196078431372549, 0.7686274509803922, 0.7686274509803922),
                  (0.22352941176470589, 0.77647058823529413, 0.77647058823529413),
                  (0.22745098039215686, 0.7803921568627451, 0.7803921568627451),
                  (0.23137254901960785, 0.78823529411764703, 0.78823529411764703),
                  (0.23529411764705882, 0.79607843137254897, 0.79607843137254897),
                  (0.23921568627450981, 0.80000000000000004, 0.80000000000000004),
                  (0.24313725490196078, 0.80784313725490198, 0.80784313725490198),
                  (0.24705882352941178, 0.81568627450980391, 0.81568627450980391),
                  (0.25098039215686274, 0.81960784313725488, 0.81960784313725488),
                  (0.25490196078431371, 0.82352941176470584, 0.82352941176470584),
                  (0.25882352941176473, 0.83137254901960789, 0.83137254901960789),
                  (0.2627450980392157, 0.83529411764705885, 0.83529411764705885),
                  (0.26666666666666666, 0.84313725490196079, 0.84313725490196079),
                  (0.27058823529411763, 0.84705882352941175, 0.84705882352941175),
                  (0.27450980392156865, 0.85098039215686272, 0.85098039215686272),
                  (0.27843137254901962, 0.85882352941176465, 0.85882352941176465),
                  (0.28235294117647058, 0.86274509803921573, 0.86274509803921573),
                  (0.28627450980392155, 0.8666666666666667, 0.8666666666666667),
                  (0.29019607843137257, 0.87058823529411766, 0.87058823529411766),
                  (0.29411764705882354, 0.61176470588235299, 0.61176470588235299),
                  (0.29803921568627451, 0.61176470588235299, 0.61176470588235299),
                  (0.30196078431372547, 0.61176470588235299, 0.61176470588235299),
                  (0.30588235294117649, 0.61176470588235299, 0.61176470588235299),
                  (0.30980392156862746, 0.61176470588235299, 0.61176470588235299),
                  (0.31372549019607843, 0.61176470588235299, 0.61176470588235299),
                  (0.31764705882352939, 0.61176470588235299, 0.61176470588235299),
                  (0.32156862745098042, 0.61176470588235299, 0.61176470588235299),
                  (0.32549019607843138, 0.61176470588235299, 0.61176470588235299),
                  (0.32941176470588235, 0.61176470588235299, 0.61176470588235299),
                  (0.33333333333333331, 0.61176470588235299, 0.61176470588235299),
                  (0.33725490196078434, 0.61176470588235299, 0.61176470588235299),
                  (0.3411764705882353, 0.61176470588235299, 0.61176470588235299),
                  (0.34509803921568627, 0.61176470588235299, 0.61176470588235299),
                  (0.34901960784313724, 0.61176470588235299, 0.61176470588235299),
                  (0.35294117647058826, 0.71372549019607845, 0.71372549019607845),
                  (0.35686274509803922, 0.71372549019607845, 0.71372549019607845),
                  (0.36078431372549019, 0.71372549019607845, 0.71372549019607845),
                  (0.36470588235294116, 0.71372549019607845, 0.71372549019607845),
                  (0.36862745098039218, 0.71372549019607845, 0.71372549019607845),
                  (0.37254901960784315, 0.71372549019607845, 0.71372549019607845),
                  (0.37647058823529411, 0.71372549019607845, 0.71372549019607845),
                  (0.38039215686274508, 0.71372549019607845, 0.71372549019607845),
                  (0.3843137254901961, 0.71372549019607845, 0.71372549019607845),
                  (0.38823529411764707, 0.71372549019607845, 0.71372549019607845),
                  (0.39215686274509803, 0.71372549019607845, 0.71372549019607845),
                  (0.396078431372549, 0.71372549019607845, 0.71372549019607845),
                  (0.40000000000000002, 0.71372549019607845, 0.71372549019607845),
                  (0.40392156862745099, 0.71372549019607845, 0.71372549019607845),
                  (0.40784313725490196, 0.71372549019607845, 0.71372549019607845),
                  (0.41176470588235292, 0.66666666666666663, 0.66666666666666663),
                  (0.41568627450980394, 0.66666666666666663, 0.66666666666666663),
                  (0.41960784313725491, 0.66666666666666663, 0.66666666666666663),
                  (0.42352941176470588, 0.66666666666666663, 0.66666666666666663),
                  (0.42745098039215684, 0.66666666666666663, 0.66666666666666663),
                  (0.43137254901960786, 0.66666666666666663, 0.66666666666666663),
                  (0.43529411764705883, 0.66666666666666663, 0.66666666666666663),
                  (0.4392156862745098, 0.66666666666666663, 0.66666666666666663),
                  (0.44313725490196076, 0.66666666666666663, 0.66666666666666663),
                  (0.44705882352941179, 0.66666666666666663, 0.66666666666666663),
                  (0.45098039215686275, 0.66666666666666663, 0.66666666666666663),
                  (0.45490196078431372, 0.66666666666666663, 0.66666666666666663),
                  (0.45882352941176469, 0.66666666666666663, 0.66666666666666663),
                  (0.46274509803921571, 0.66666666666666663, 0.66666666666666663),
                  (0.46666666666666667, 0.66666666666666663, 0.66666666666666663),
                  (0.47058823529411764, 0.63137254901960782, 0.63137254901960782),
                  (0.47450980392156861, 0.63137254901960782, 0.63137254901960782),
                  (0.47843137254901963, 0.63137254901960782, 0.63137254901960782),
                  (0.4823529411764706, 0.63137254901960782, 0.63137254901960782),
                  (0.48627450980392156, 0.63137254901960782, 0.63137254901960782),
                  (0.49019607843137253, 0.63137254901960782, 0.63137254901960782),
                  (0.49411764705882355, 0.63137254901960782, 0.63137254901960782),
                  (0.49803921568627452, 0.63137254901960782, 0.63137254901960782),
                  (0.50196078431372548, 0.63137254901960782, 0.63137254901960782),
                  (0.50588235294117645, 0.63137254901960782, 0.63137254901960782),
                  (0.50980392156862742, 0.63137254901960782, 0.63137254901960782),
                  (0.51372549019607838, 0.63137254901960782, 0.63137254901960782),
                  (0.51764705882352946, 0.63137254901960782, 0.63137254901960782),
                  (0.52156862745098043, 0.63137254901960782, 0.63137254901960782),
                  (0.52549019607843139, 0.63137254901960782, 0.63137254901960782),
                  (0.52941176470588236, 0.58039215686274515, 0.58039215686274515),
                  (0.53333333333333333, 0.58039215686274515, 0.58039215686274515),
                  (0.53725490196078429, 0.58039215686274515, 0.58039215686274515),
                  (0.54117647058823526, 0.58039215686274515, 0.58039215686274515),
                  (0.54509803921568623, 0.58039215686274515, 0.58039215686274515),
                  (0.5490196078431373, 0.58039215686274515, 0.58039215686274515),
                  (0.55294117647058827, 0.58039215686274515, 0.58039215686274515),
                  (0.55686274509803924, 0.58039215686274515, 0.58039215686274515),
                  (0.5607843137254902, 0.58039215686274515, 0.58039215686274515),
                  (0.56470588235294117, 0.58039215686274515, 0.58039215686274515),
                  (0.56862745098039214, 0.58039215686274515, 0.58039215686274515),
                  (0.5725490196078431, 0.58039215686274515, 0.58039215686274515),
                  (0.57647058823529407, 0.58039215686274515, 0.58039215686274515),
                  (0.58039215686274515, 0.58039215686274515, 0.58039215686274515),
                  (0.58431372549019611, 0.58039215686274515, 0.58039215686274515),
                  (0.58823529411764708, 0.52549019607843139, 0.52549019607843139),
                  (0.59215686274509804, 0.52549019607843139, 0.52549019607843139),
                  (0.59607843137254901, 0.52549019607843139, 0.52549019607843139),
                  (0.59999999999999998, 0.52549019607843139, 0.52549019607843139),
                  (0.60392156862745094, 0.52549019607843139, 0.52549019607843139),
                  (0.60784313725490191, 0.52549019607843139, 0.52549019607843139),
                  (0.61176470588235299, 0.52549019607843139, 0.52549019607843139),
                  (0.61568627450980395, 0.52549019607843139, 0.52549019607843139),
                  (0.61960784313725492, 0.52549019607843139, 0.52549019607843139),
                  (0.62352941176470589, 0.52549019607843139, 0.52549019607843139),
                  (0.62745098039215685, 0.52549019607843139, 0.52549019607843139),
                  (0.63137254901960782, 0.52549019607843139, 0.52549019607843139),
                  (0.63529411764705879, 0.52549019607843139, 0.52549019607843139),
                  (0.63921568627450975, 0.52549019607843139, 0.52549019607843139),
                  (0.64313725490196083, 0.52549019607843139, 0.52549019607843139),
                  (0.6470588235294118, 0.45098039215686275, 0.45098039215686275),
                  (0.65098039215686276, 0.45098039215686275, 0.45098039215686275),
                  (0.65490196078431373, 0.45098039215686275, 0.45098039215686275),
                  (0.6588235294117647, 0.45098039215686275, 0.45098039215686275),
                  (0.66274509803921566, 0.45098039215686275, 0.45098039215686275),
                  (0.66666666666666663, 0.45098039215686275, 0.45098039215686275),
                  (0.6705882352941176, 0.45098039215686275, 0.45098039215686275),
                  (0.67450980392156867, 0.45098039215686275, 0.45098039215686275),
                  (0.67843137254901964, 0.45098039215686275, 0.45098039215686275),
                  (0.68235294117647061, 0.45098039215686275, 0.45098039215686275),
                  (0.68627450980392157, 0.45098039215686275, 0.45098039215686275),
                  (0.69019607843137254, 0.45098039215686275, 0.45098039215686275),
                  (0.69411764705882351, 0.45098039215686275, 0.45098039215686275),
                  (0.69803921568627447, 0.45098039215686275, 0.45098039215686275),
                  (0.70196078431372544, 0.45098039215686275, 0.45098039215686275),
                  (0.70588235294117652, 0.37254901960784315, 0.37254901960784315),
                  (0.70980392156862748, 0.37254901960784315, 0.37254901960784315),
                  (0.71372549019607845, 0.37254901960784315, 0.37254901960784315),
                  (0.71764705882352942, 0.37254901960784315, 0.37254901960784315),
                  (0.72156862745098038, 0.37254901960784315, 0.37254901960784315),
                  (0.72549019607843135, 0.37254901960784315, 0.37254901960784315),
                  (0.72941176470588232, 0.37254901960784315, 0.37254901960784315),
                  (0.73333333333333328, 0.37254901960784315, 0.37254901960784315),
                  (0.73725490196078436, 0.37254901960784315, 0.37254901960784315),
                  (0.74117647058823533, 0.37254901960784315, 0.37254901960784315),
                  (0.74509803921568629, 0.37254901960784315, 0.37254901960784315),
                  (0.74901960784313726, 0.37254901960784315, 0.37254901960784315),
                  (0.75294117647058822, 0.37254901960784315, 0.37254901960784315),
                  (0.75686274509803919, 0.37254901960784315, 0.37254901960784315),
                  (0.76078431372549016, 0.37254901960784315, 0.37254901960784315),
                  (0.76470588235294112, 0.28235294117647058, 0.28235294117647058),
                  (0.7686274509803922, 0.28235294117647058, 0.28235294117647058),
                  (0.77254901960784317, 0.28235294117647058, 0.28235294117647058),
                  (0.77647058823529413, 0.28235294117647058, 0.28235294117647058),
                  (0.7803921568627451, 0.28235294117647058, 0.28235294117647058),
                  (0.78431372549019607, 0.28235294117647058, 0.28235294117647058),
                  (0.78823529411764703, 0.28235294117647058, 0.28235294117647058),
                  (0.792156862745098, 0.28235294117647058, 0.28235294117647058),
                  (0.79607843137254897, 0.28235294117647058, 0.28235294117647058),
                  (0.80000000000000004, 0.28235294117647058, 0.28235294117647058),
                  (0.80392156862745101, 0.28235294117647058, 0.28235294117647058),
                  (0.80784313725490198, 0.28235294117647058, 0.28235294117647058),
                  (0.81176470588235294, 0.28235294117647058, 0.28235294117647058),
                  (0.81568627450980391, 0.28235294117647058, 0.28235294117647058),
                  (0.81960784313725488, 0.28235294117647058, 0.28235294117647058),
                  (0.82352941176470584, 0.21568627450980393, 0.21568627450980393),
                  (0.82745098039215681, 0.21568627450980393, 0.21568627450980393),
                  (0.83137254901960789, 0.21568627450980393, 0.21568627450980393),
                  (0.83529411764705885, 0.21568627450980393, 0.21568627450980393),
                  (0.83921568627450982, 0.21568627450980393, 0.21568627450980393),
                  (0.84313725490196079, 0.21568627450980393, 0.21568627450980393),
                  (0.84705882352941175, 0.21568627450980393, 0.21568627450980393),
                  (0.85098039215686272, 0.21568627450980393, 0.21568627450980393),
                  (0.85490196078431369, 0.21568627450980393, 0.21568627450980393),
                  (0.85882352941176465, 0.21568627450980393, 0.21568627450980393),
                  (0.86274509803921573, 0.21568627450980393, 0.21568627450980393),
                  (0.8666666666666667, 0.21568627450980393, 0.21568627450980393),
                  (0.87058823529411766, 0.21568627450980393, 0.21568627450980393),
                  (0.87450980392156863, 0.21568627450980393, 0.21568627450980393),
                  (0.8784313725490196, 0.21568627450980393, 0.21568627450980393),
                  (0.88235294117647056, 0.16078431372549021, 0.16078431372549021),
                  (0.88627450980392153, 0.16078431372549021, 0.16078431372549021),
                  (0.8901960784313725, 0.16078431372549021, 0.16078431372549021),
                  (0.89411764705882357, 0.16078431372549021, 0.16078431372549021),
                  (0.89803921568627454, 0.16078431372549021, 0.16078431372549021),
                  (0.90196078431372551, 0.16078431372549021, 0.16078431372549021),
                  (0.90588235294117647, 0.16078431372549021, 0.16078431372549021),
                  (0.90980392156862744, 0.16078431372549021, 0.16078431372549021),
                  (0.9137254901960784, 0.16078431372549021, 0.16078431372549021),
                  (0.91764705882352937, 0.16078431372549021, 0.16078431372549021),
                  (0.92156862745098034, 0.16078431372549021, 0.16078431372549021),
                  (0.92549019607843142, 0.16078431372549021, 0.16078431372549021),
                  (0.92941176470588238, 0.16078431372549021, 0.16078431372549021),
                  (0.93333333333333335, 0.16078431372549021, 0.16078431372549021),
                  (0.93725490196078431, 0.16078431372549021, 0.16078431372549021),
                  (0.94117647058823528, 0.074509803921568626, 0.074509803921568626),
                  (0.94509803921568625, 0.074509803921568626, 0.074509803921568626),
                  (0.94901960784313721, 0.074509803921568626, 0.074509803921568626),
                  (0.95294117647058818, 0.074509803921568626, 0.074509803921568626),
                  (0.95686274509803926, 0.074509803921568626, 0.074509803921568626),
                  (0.96078431372549022, 0.074509803921568626, 0.074509803921568626),
                  (0.96470588235294119, 0.074509803921568626, 0.074509803921568626),
                  (0.96862745098039216, 0.074509803921568626, 0.074509803921568626),
                  (0.97254901960784312, 0.074509803921568626, 0.074509803921568626),
                  (0.97647058823529409, 0.074509803921568626, 0.074509803921568626),
                  (0.98039215686274506, 0.074509803921568626, 0.074509803921568626),
                  (0.98431372549019602, 0.074509803921568626, 0.074509803921568626),
                  (0.9882352941176471, 0.074509803921568626, 0.074509803921568626),
                  (0.99215686274509807, 0.074509803921568626, 0.074509803921568626),
                  (0.99607843137254903, 0.074509803921568626, 0.074509803921568626),
                  (1.0, 0.074509803921568626, 0.074509803921568626)],

        'red': [  (0.0, 0.92156862745098034, 0.92156862745098034),
                  (0.0039215686274509803, 0.92156862745098034, 0.92156862745098034),
                  (0.0078431372549019607, 0.92156862745098034, 0.92156862745098034),
                  (0.011764705882352941, 0.92156862745098034, 0.92156862745098034),
                  (0.015686274509803921, 0.92156862745098034, 0.92156862745098034),
                  (0.019607843137254902, 0.92156862745098034, 0.92156862745098034),
                  (0.023529411764705882, 0.92156862745098034, 0.92156862745098034),
                  (0.027450980392156862, 0.92156862745098034, 0.92156862745098034),
                  (0.031372549019607843, 0.92156862745098034, 0.92156862745098034),
                  (0.035294117647058823, 0.92156862745098034, 0.92156862745098034),
                  (0.039215686274509803, 0.92156862745098034, 0.92156862745098034),
                  (0.043137254901960784, 0.92156862745098034, 0.92156862745098034),
                  (0.047058823529411764, 0.92156862745098034, 0.92156862745098034),
                  (0.050980392156862744, 0.92156862745098034, 0.92156862745098034),
                  (0.054901960784313725, 0.92156862745098034, 0.92156862745098034),
                  (0.058823529411764705, 0.92156862745098034, 0.92156862745098034),
                  (0.062745098039215685, 0.792156862745098, 0.792156862745098),
                  (0.066666666666666666, 0.79607843137254897, 0.79607843137254897),
                  (0.070588235294117646, 0.80000000000000004, 0.80000000000000004),
                  (0.074509803921568626, 0.80784313725490198, 0.80784313725490198),
                  (0.078431372549019607, 0.81176470588235294, 0.81176470588235294),
                  (0.082352941176470587, 0.81960784313725488, 0.81960784313725488),
                  (0.086274509803921567, 0.82352941176470584, 0.82352941176470584),
                  (0.090196078431372548, 0.82745098039215681, 0.82745098039215681),
                  (0.094117647058823528, 0.83529411764705885, 0.83529411764705885),
                  (0.098039215686274508, 0.83921568627450982, 0.83921568627450982),
                  (0.10196078431372549, 0.84313725490196079, 0.84313725490196079),
                  (0.10588235294117647, 0.85098039215686272, 0.85098039215686272),
                  (0.10980392156862745, 0.85490196078431369, 0.85490196078431369),
                  (0.11372549019607843, 0.85882352941176465, 0.85882352941176465),
                  (0.11764705882352941, 0.8666666666666667, 0.8666666666666667),
                  (0.12156862745098039, 0.87058823529411766, 0.87058823529411766),
                  (0.12549019607843137, 0.87450980392156863, 0.87450980392156863),
                  (0.12941176470588237, 0.8784313725490196, 0.8784313725490196),
                  (0.13333333333333333, 0.88627450980392153, 0.88627450980392153),
                  (0.13725490196078433, 0.8901960784313725, 0.8901960784313725),
                  (0.14117647058823529, 0.89411764705882357, 0.89411764705882357),
                  (0.14509803921568629, 0.89803921568627454, 0.89803921568627454),
                  (0.14901960784313725, 0.90196078431372551, 0.90196078431372551),
                  (0.15294117647058825, 0.90588235294117647, 0.90588235294117647),
                  (0.15686274509803921, 0.9137254901960784, 0.9137254901960784),
                  (0.16078431372549021, 0.91764705882352937, 0.91764705882352937),
                  (0.16470588235294117, 0.92156862745098034, 0.92156862745098034),
                  (0.16862745098039217, 0.92549019607843142, 0.92549019607843142),
                  (0.17254901960784313, 0.92941176470588238, 0.92941176470588238),
                  (0.17647058823529413, 0.93333333333333335, 0.93333333333333335),
                  (0.1803921568627451, 0.93725490196078431, 0.93725490196078431),
                  (0.18431372549019609, 0.94117647058823528, 0.94117647058823528),
                  (0.18823529411764706, 0.94509803921568625, 0.94509803921568625),
                  (0.19215686274509805, 0.94901960784313721, 0.94901960784313721),
                  (0.19607843137254902, 0.94901960784313721, 0.94901960784313721),
                  (0.20000000000000001, 0.95294117647058818, 0.95294117647058818),
                  (0.20392156862745098, 0.95686274509803926, 0.95686274509803926),
                  (0.20784313725490197, 0.96078431372549022, 0.96078431372549022),
                  (0.21176470588235294, 0.96470588235294119, 0.96470588235294119),
                  (0.21568627450980393, 0.96470588235294119, 0.96470588235294119),
                  (0.2196078431372549, 0.96862745098039216, 0.96862745098039216),
                  (0.22352941176470589, 0.97254901960784312, 0.97254901960784312),
                  (0.22745098039215686, 0.97254901960784312, 0.97254901960784312),
                  (0.23137254901960785, 0.97647058823529409, 0.97647058823529409),
                  (0.23529411764705882, 0.98039215686274506, 0.98039215686274506),
                  (0.23921568627450981, 0.98039215686274506, 0.98039215686274506),
                  (0.24313725490196078, 0.98431372549019602, 0.98431372549019602),
                  (0.24705882352941178, 0.98431372549019602, 0.98431372549019602),
                  (0.25098039215686274, 0.9882352941176471, 0.9882352941176471),
                  (0.25490196078431371, 0.9882352941176471, 0.9882352941176471),
                  (0.25882352941176473, 0.99215686274509807, 0.99215686274509807),
                  (0.2627450980392157, 0.99215686274509807, 0.99215686274509807),
                  (0.26666666666666666, 0.99215686274509807, 0.99215686274509807),
                  (0.27058823529411763, 0.99607843137254903, 0.99607843137254903),
                  (0.27450980392156865, 0.99607843137254903, 0.99607843137254903),
                  (0.27843137254901962, 0.99607843137254903, 0.99607843137254903),
                  (0.28235294117647058, 1.0, 1.0),
                  (0.28627450980392155, 1.0, 1.0),
                  (0.29019607843137257, 1.0, 1.0),
                  (0.29411764705882354, 0.49411764705882355, 0.49411764705882355),
                  (0.29803921568627451, 0.49411764705882355, 0.49411764705882355),
                  (0.30196078431372547, 0.49411764705882355, 0.49411764705882355),
                  (0.30588235294117649, 0.49411764705882355, 0.49411764705882355),
                  (0.30980392156862746, 0.49411764705882355, 0.49411764705882355),
                  (0.31372549019607843, 0.49411764705882355, 0.49411764705882355),
                  (0.31764705882352939, 0.49411764705882355, 0.49411764705882355),
                  (0.32156862745098042, 0.49411764705882355, 0.49411764705882355),
                  (0.32549019607843138, 0.49411764705882355, 0.49411764705882355),
                  (0.32941176470588235, 0.49411764705882355, 0.49411764705882355),
                  (0.33333333333333331, 0.49411764705882355, 0.49411764705882355),
                  (0.33725490196078434, 0.49411764705882355, 0.49411764705882355),
                  (0.3411764705882353, 0.49411764705882355, 0.49411764705882355),
                  (0.34509803921568627, 0.49411764705882355, 0.49411764705882355),
                  (0.34901960784313724, 0.49411764705882355, 0.49411764705882355),
                  (0.35294117647058826, 0.58823529411764708, 0.58823529411764708),
                  (0.35686274509803922, 0.58823529411764708, 0.58823529411764708),
                  (0.36078431372549019, 0.58823529411764708, 0.58823529411764708),
                  (0.36470588235294116, 0.58823529411764708, 0.58823529411764708),
                  (0.36862745098039218, 0.58823529411764708, 0.58823529411764708),
                  (0.37254901960784315, 0.58823529411764708, 0.58823529411764708),
                  (0.37647058823529411, 0.58823529411764708, 0.58823529411764708),
                  (0.38039215686274508, 0.58823529411764708, 0.58823529411764708),
                  (0.3843137254901961, 0.58823529411764708, 0.58823529411764708),
                  (0.38823529411764707, 0.58823529411764708, 0.58823529411764708),
                  (0.39215686274509803, 0.58823529411764708, 0.58823529411764708),
                  (0.396078431372549, 0.58823529411764708, 0.58823529411764708),
                  (0.40000000000000002, 0.58823529411764708, 0.58823529411764708),
                  (0.40392156862745099, 0.58823529411764708, 0.58823529411764708),
                  (0.40784313725490196, 0.58823529411764708, 0.58823529411764708),
                  (0.41176470588235292, 0.45882352941176469, 0.45882352941176469),
                  (0.41568627450980394, 0.45882352941176469, 0.45882352941176469),
                  (0.41960784313725491, 0.45882352941176469, 0.45882352941176469),
                  (0.42352941176470588, 0.45882352941176469, 0.45882352941176469),
                  (0.42745098039215684, 0.45882352941176469, 0.45882352941176469),
                  (0.43137254901960786, 0.45882352941176469, 0.45882352941176469),
                  (0.43529411764705883, 0.45882352941176469, 0.45882352941176469),
                  (0.4392156862745098, 0.45882352941176469, 0.45882352941176469),
                  (0.44313725490196076, 0.45882352941176469, 0.45882352941176469),
                  (0.44705882352941179, 0.45882352941176469, 0.45882352941176469),
                  (0.45098039215686275, 0.45882352941176469, 0.45882352941176469),
                  (0.45490196078431372, 0.45882352941176469, 0.45882352941176469),
                  (0.45882352941176469, 0.45882352941176469, 0.45882352941176469),
                  (0.46274509803921571, 0.45882352941176469, 0.45882352941176469),
                  (0.46666666666666667, 0.45882352941176469, 0.45882352941176469),
                  (0.47058823529411764, 0.40392156862745099, 0.40392156862745099),
                  (0.47450980392156861, 0.40392156862745099, 0.40392156862745099),
                  (0.47843137254901963, 0.40392156862745099, 0.40392156862745099),
                  (0.4823529411764706, 0.40392156862745099, 0.40392156862745099),
                  (0.48627450980392156, 0.40392156862745099, 0.40392156862745099),
                  (0.49019607843137253, 0.40392156862745099, 0.40392156862745099),
                  (0.49411764705882355, 0.40392156862745099, 0.40392156862745099),
                  (0.49803921568627452, 0.40392156862745099, 0.40392156862745099),
                  (0.50196078431372548, 0.40392156862745099, 0.40392156862745099),
                  (0.50588235294117645, 0.40392156862745099, 0.40392156862745099),
                  (0.50980392156862742, 0.40392156862745099, 0.40392156862745099),
                  (0.51372549019607838, 0.40392156862745099, 0.40392156862745099),
                  (0.51764705882352946, 0.40392156862745099, 0.40392156862745099),
                  (0.52156862745098043, 0.40392156862745099, 0.40392156862745099),
                  (0.52549019607843139, 0.40392156862745099, 0.40392156862745099),
                  (0.52941176470588236, 0.32156862745098042, 0.32156862745098042),
                  (0.53333333333333333, 0.32156862745098042, 0.32156862745098042),
                  (0.53725490196078429, 0.32156862745098042, 0.32156862745098042),
                  (0.54117647058823526, 0.32156862745098042, 0.32156862745098042),
                  (0.54509803921568623, 0.32156862745098042, 0.32156862745098042),
                  (0.5490196078431373, 0.32156862745098042, 0.32156862745098042),
                  (0.55294117647058827, 0.32156862745098042, 0.32156862745098042),
                  (0.55686274509803924, 0.32156862745098042, 0.32156862745098042),
                  (0.5607843137254902, 0.32156862745098042, 0.32156862745098042),
                  (0.56470588235294117, 0.32156862745098042, 0.32156862745098042),
                  (0.56862745098039214, 0.32156862745098042, 0.32156862745098042),
                  (0.5725490196078431, 0.32156862745098042, 0.32156862745098042),
                  (0.57647058823529407, 0.32156862745098042, 0.32156862745098042),
                  (0.58039215686274515, 0.32156862745098042, 0.32156862745098042),
                  (0.58431372549019611, 0.32156862745098042, 0.32156862745098042),
                  (0.58823529411764708, 0.23921568627450981, 0.23921568627450981),
                  (0.59215686274509804, 0.23921568627450981, 0.23921568627450981),
                  (0.59607843137254901, 0.23921568627450981, 0.23921568627450981),
                  (0.59999999999999998, 0.23921568627450981, 0.23921568627450981),
                  (0.60392156862745094, 0.23921568627450981, 0.23921568627450981),
                  (0.60784313725490191, 0.23921568627450981, 0.23921568627450981),
                  (0.61176470588235299, 0.23921568627450981, 0.23921568627450981),
                  (0.61568627450980395, 0.23921568627450981, 0.23921568627450981),
                  (0.61960784313725492, 0.23921568627450981, 0.23921568627450981),
                  (0.62352941176470589, 0.23921568627450981, 0.23921568627450981),
                  (0.62745098039215685, 0.23921568627450981, 0.23921568627450981),
                  (0.63137254901960782, 0.23921568627450981, 0.23921568627450981),
                  (0.63529411764705879, 0.23921568627450981, 0.23921568627450981),
                  (0.63921568627450975, 0.23921568627450981, 0.23921568627450981),
                  (0.64313725490196083, 0.23921568627450981, 0.23921568627450981),
                  (0.6470588235294118, 0.10980392156862745, 0.10980392156862745),
                  (0.65098039215686276, 0.10980392156862745, 0.10980392156862745),
                  (0.65490196078431373, 0.10980392156862745, 0.10980392156862745),
                  (0.6588235294117647, 0.10980392156862745, 0.10980392156862745),
                  (0.66274509803921566, 0.10980392156862745, 0.10980392156862745),
                  (0.66666666666666663, 0.10980392156862745, 0.10980392156862745),
                  (0.6705882352941176, 0.10980392156862745, 0.10980392156862745),
                  (0.67450980392156867, 0.10980392156862745, 0.10980392156862745),
                  (0.67843137254901964, 0.10980392156862745, 0.10980392156862745),
                  (0.68235294117647061, 0.10980392156862745, 0.10980392156862745),
                  (0.68627450980392157, 0.10980392156862745, 0.10980392156862745),
                  (0.69019607843137254, 0.10980392156862745, 0.10980392156862745),
                  (0.69411764705882351, 0.10980392156862745, 0.10980392156862745),
                  (0.69803921568627447, 0.10980392156862745, 0.10980392156862745),
                  (0.70196078431372544, 0.10980392156862745, 0.10980392156862745),
                  (0.70588235294117652, 0.0, 0.0),
                  (0.70980392156862748, 0.0, 0.0),
                  (0.71372549019607845, 0.0, 0.0),
                  (0.71764705882352942, 0.0, 0.0),
                  (0.72156862745098038, 0.0, 0.0),
                  (0.72549019607843135, 0.0, 0.0),
                  (0.72941176470588232, 0.0, 0.0),
                  (0.73333333333333328, 0.0, 0.0),
                  (0.73725490196078436, 0.0, 0.0),
                  (0.74117647058823533, 0.0, 0.0),
                  (0.74509803921568629, 0.0, 0.0),
                  (0.74901960784313726, 0.0, 0.0),
                  (0.75294117647058822, 0.0, 0.0),
                  (0.75686274509803919, 0.0, 0.0),
                  (0.76078431372549016, 0.0, 0.0),
                  (0.76470588235294112, 0.0, 0.0),
                  (0.7686274509803922, 0.0, 0.0),
                  (0.77254901960784317, 0.0, 0.0),
                  (0.77647058823529413, 0.0, 0.0),
                  (0.7803921568627451, 0.0, 0.0),
                  (0.78431372549019607, 0.0, 0.0),
                  (0.78823529411764703, 0.0, 0.0),
                  (0.792156862745098, 0.0, 0.0),
                  (0.79607843137254897, 0.0, 0.0),
                  (0.80000000000000004, 0.0, 0.0),
                  (0.80392156862745101, 0.0, 0.0),
                  (0.80784313725490198, 0.0, 0.0),
                  (0.81176470588235294, 0.0, 0.0),
                  (0.81568627450980391, 0.0, 0.0),
                  (0.81960784313725488, 0.0, 0.0),
                  (0.82352941176470584, 0.0078431372549019607, 0.0078431372549019607),
                  (0.82745098039215681, 0.0078431372549019607, 0.0078431372549019607),
                  (0.83137254901960789, 0.0078431372549019607, 0.0078431372549019607),
                  (0.83529411764705885, 0.0078431372549019607, 0.0078431372549019607),
                  (0.83921568627450982, 0.0078431372549019607, 0.0078431372549019607),
                  (0.84313725490196079, 0.0078431372549019607, 0.0078431372549019607),
                  (0.84705882352941175, 0.0078431372549019607, 0.0078431372549019607),
                  (0.85098039215686272, 0.0078431372549019607, 0.0078431372549019607),
                  (0.85490196078431369, 0.0078431372549019607, 0.0078431372549019607),
                  (0.85882352941176465, 0.0078431372549019607, 0.0078431372549019607),
                  (0.86274509803921573, 0.0078431372549019607, 0.0078431372549019607),
                  (0.8666666666666667, 0.0078431372549019607, 0.0078431372549019607),
                  (0.87058823529411766, 0.0078431372549019607, 0.0078431372549019607),
                  (0.87450980392156863, 0.0078431372549019607, 0.0078431372549019607),
                  (0.8784313725490196, 0.0078431372549019607, 0.0078431372549019607),
                  (0.88235294117647056, 0.0, 0.0),
                  (0.88627450980392153, 0.0, 0.0),
                  (0.8901960784313725, 0.0, 0.0),
                  (0.89411764705882357, 0.0, 0.0),
                  (0.89803921568627454, 0.0, 0.0),
                  (0.90196078431372551, 0.0, 0.0),
                  (0.90588235294117647, 0.0, 0.0),
                  (0.90980392156862744, 0.0, 0.0),
                  (0.9137254901960784, 0.0, 0.0),
                  (0.91764705882352937, 0.0, 0.0),
                  (0.92156862745098034, 0.0, 0.0),
                  (0.92549019607843142, 0.0, 0.0),
                  (0.92941176470588238, 0.0, 0.0),
                  (0.93333333333333335, 0.0, 0.0),
                  (0.93725490196078431, 0.0, 0.0),
                  (0.94117647058823528, 0.0039215686274509803, 0.0039215686274509803),
                  (0.94509803921568625, 0.0039215686274509803, 0.0039215686274509803),
                  (0.94901960784313721, 0.0039215686274509803, 0.0039215686274509803),
                  (0.95294117647058818, 0.0039215686274509803, 0.0039215686274509803),
                  (0.95686274509803926, 0.0039215686274509803, 0.0039215686274509803),
                  (0.96078431372549022, 0.0039215686274509803, 0.0039215686274509803),
                  (0.96470588235294119, 0.0039215686274509803, 0.0039215686274509803),
                  (0.96862745098039216, 0.0039215686274509803, 0.0039215686274509803),
                  (0.97254901960784312, 0.0039215686274509803, 0.0039215686274509803),
                  (0.97647058823529409, 0.0039215686274509803, 0.0039215686274509803),
                  (0.98039215686274506, 0.0039215686274509803, 0.0039215686274509803),
                  (0.98431372549019602, 0.0039215686274509803, 0.0039215686274509803),
                  (0.9882352941176471, 0.0039215686274509803, 0.0039215686274509803),
                  (0.99215686274509807, 0.0039215686274509803, 0.0039215686274509803),
                  (0.99607843137254903, 0.0039215686274509803, 0.0039215686274509803),
                  (1.0, 0.0039215686274509803, 0.0039215686274509803)]
                  }

ndvi_cmap = LinearSegmentedColormap('ndvi', ndvi_cmdata)

def _create_input_file_globs(inputFiles):
    '''
    Determine the correct input file path and globs
    '''
    input_path = path.abspath(path.expanduser(inputFiles))
    if path.isdir(input_path) :
        input_dir = input_path
        input_files = None
    else :
        input_dir = path.dirname(input_path)
        input_files = path.basename(input_path)

    LOG.debug("input_path = %s" %(input_path))
    LOG.debug("input_dir = %s" %(input_dir))
    LOG.debug("input_files = %s" %(input_files))

    inputGlob = None

    charsToKill = string.ascii_letters + string.digits + "."

    if (input_files is None):
        # Input file glob is of form "/path/to/files"
        LOG.debug('Path1')
        inputGlob = '*.h5'

    elif path.isfile(input_path) :
        # Input file glob is of form "/path/to/files/full_file_name.h5" 
        LOG.debug('Path2')
        fileGlob = string.rstrip(string.lstrip(string.split(input_files,"b")[0],charsToKill),charsToKill)
        LOG.debug("fileGlob = %s" %(fileGlob))
        inputGlob = "*%s*.h5" %(fileGlob)
        LOG.debug("Initial inputGlob = %s" %(inputGlob))
        while (string.find(inputGlob,"**")!= -1): 
            inputGlob = string.replace(inputGlob,"**","*")
            LOG.debug("New inputGlob = %s" %(inputGlob))

    elif ("*" in input_files):
        # Input file glob is of form "/path/to/files/something*else"
        LOG.debug('Path3')
        #fileGlob = string.rstrip(string.lstrip(string.split(input_files,"b")[0],charsToKill),charsToKill)
        fileGlob = input_files
        inputGlob = "{}".format(fileGlob)
        LOG.debug("Initial inputGlob = %s" %(inputGlob))
        while (string.find(inputGlob,"**")!= -1): 
            inputGlob = string.replace(inputGlob,"**","*")
            LOG.debug("New inputGlob = %s" %(inputGlob))

    return input_dir,inputGlob


def _create_ndvi_object_pytables(input_files,output_file):
    ''' Create a new output file and populate the attributes. '''

    LOG.debug("Opening the min/max NDVI file {}".format(path.basename(output_file)))

    f = pytables.open_file(output_file,'w',title="Min/Max Average NDVI")

    f.setNodeAttr('/','Author','Geoff Cureton')
    f.setNodeAttr('/','email','<geoff.cureton@ssec.wisc.edu>')
    f.setNodeAttr('/','input 16-day NDVI files',np.array(input_files))

    LOG.debug(input_files)
    
    LOG.debug("Closing HDF5 file")

    f.close()

def _create_ndvi_object_h5py(input_files,dset_dicts,output_file):
    ''' Create a new output file and populate the attributes. '''

    LOG.debug("Opening the min/max NDVI file {}".format(path.basename(output_file)))

    f = h5py.File(output_file,'w')

    f.attrs['Author'] = "Geoff Cureton"
    f.attrs['email'] = "<geoff.cureton@ssec.wisc.edu>"
    f.attrs['input 16-day NDVI files'] = np.array(input_files)

    # Copy the datasets and their associated attributes to the 
    # hdf5 file.
    for dset in ['Latitude','Longitude','min_ndvi','max_ndvi']:
        LOG.debug(dset)
        #dset_obj = f[dset]
        f[dset] = dset_dicts[dset]['data']
        attr_list = dset_dicts[dset].keys()
        attr_list.remove('data')
        LOG.debug(attr_list)
        for attr_key in attr_list:
            #dset_obj.attrs[attr_key] = dset_dicts[dset][attr_key]
            f[dset].attrs[attr_key] = dset_dicts[dset][attr_key]

    #f['Latitude'] = dset_dicts['Latitude']['data']
    #f['Longitude'] = dset_dicts['Longitude']['data']
    #f['min_ndvi'] = dset_dicts['min_ndvi']['data']
    #f['max_ndvi'] = dset_dicts['max_ndvi']['data']

    #for dset in ['Latitude','Longitude','min_ndvi','max_ndvi']:
        #LOG.debug(dset)
        #for attr_key in dset_dicts[dset].keys():
            #LOG.debug('\t{} = {}'.format(attr_key,dset_dicts[dset][attr_key]))

    
    LOG.debug("Closing HDF5 file")

    f.close()


def _plot_ndvi(dset_dicts,dset,title=None):

        Latitude  = dset_dicts['Latitude']['data']
        Longitude = dset_dicts['Longitude']['data']
        dataset = dset_dicts[dset]['data'][::-1,:]
        fill_value = dset_dicts[dset]['_FillValue']
        scale_factor = dset_dicts[dset]['scale_factor']
        offset = dset_dicts[dset]['add_offset']

        dataset_mask = ma.masked_equal(dataset,fill_value).mask
        dataset = scale_factor * dataset.astype('float32') + offset
        dataset = ma.array(dataset,mask=dataset_mask)

        # A default 0.5 degree grid...
        lon,lat = np.meshgrid(Longitude,Latitude)

        # Create figure with default size, and create canvas to draw on
        scale=1.5
        fig = Figure(figsize=(scale*8,scale*5))
        canvas = FigureCanvas(fig)

        # Create main axes instance, leaving room for colorbar at bottom,
        # and also get the Bbox of the axes instance
        ax_rect = [0.05, 0.18, 0.9, 0.75  ] # [left,bottom,width,height]
        ax = fig.add_axes(ax_rect)

        # Granule axis title
        ax_title = ppl.setp(ax,title=title)
        ppl.setp(ax_title,fontsize=12)
        ppl.setp(ax_title,family="sans-serif")

        # Create the basemap object
        m = Basemap(projection='cyl',lon_0=0.,ax=ax)
        x,y = m(lon,lat)

        # Plot the data
        im = m.imshow(dataset,axes=ax,interpolation='nearest',vmin=-0.05,vmax=1.0,cmap=ndvi_cmap)
        
        m.drawmapboundary(ax=ax,linewidth=0.01,fill_color='grey')
        m.drawcoastlines(ax=ax,linewidth=0.5)

        # draw parallels
        delat = 30.
        circles = np.arange(-90.,90.+delat,delat)
        m.drawparallels(circles,ax=ax,labelstyle="+/-",labels=[1,0,0,0])

        # draw meridians
        delon = 60.
        meridians = np.arange(-180,180,delon)
        m.drawmeridians(meridians,ax=ax,labelstyle="+/-",labels=[0,0,0,1])

        # add a colorbar axis
        cax_rect = [0.05 , 0.05, 0.9 , 0.06 ] # [left,bottom,width,height]
        cax = fig.add_axes(cax_rect,frameon=False) # setup colorbar axes

        # Plot the colorbar.
        cb = fig.colorbar(im, cax=cax, orientation='horizontal')
        ppl.setp(cax.get_xticklabels(),fontsize=9)

        # Colourbar title
        cax_title = ppl.setp(cax,title='NDVI')
        ppl.setp(cax_title,fontsize=9)

        # Redraw the figure
        canvas.draw()

        # save image 
        pngFile = "{}.png".format(dset)
        print "Writing file to {}".format(pngFile)
        canvas.print_figure(pngFile,dpi=300)

        del(m)
        return 0


def _argparse():
    '''
    Method to encapsulate the option parsing and various setup tasks.
    '''

    import argparse

    optChoices=['choice1','choice2','choice3']

    defaults = {
                'input_file' : None,
                'optChoice'  : 'choice1',
                'setTrue'    : False,
                'floatVar'   : 1.23,
                'stride'     : 1,
                'strVar'     : 'Hello Joe'
                }

    description = '''Boilerplate code which shows how to use argparse, and tries to exercise
most of the input types.'''
    usage = "usage: %prog [mandatory args] [options]"
    version = __version__

    parser = argparse.ArgumentParser()

    # Mandatory arguments

    parser.add_argument('-i','--input_file',
                      action='store',
                      dest='input_file',
                      type=str,
                      required=True,
                      help="The fully qualified path to the input files. May be a directory or a file glob."
                      )

    # Optional arguments 

    parser.add_argument('--optChoice',
                      action="store",
                      dest="optChoice",
                      default=defaults["optChoice"],
                      type=str,
                      choices=optChoices,
                      help='''An example of an option which can take one of\n
                              several values. Possible options here are...\n
                              {}.
                           '''.format(optChoices.__str__()[1:-1])
                      )

    parser.add_argument('--setTrue',
                      action="store_true",
                      dest="setTrue",
                      default=defaults["setTrue"],
                      help="An example of a flag option, the giving of which sets a boolean variable to 'true' [default: {}]".format(defaults["setTrue"])
                      )

    parser.add_argument('--setFloatVar',
                      action="store",
                      dest="floatVar",
                      default=defaults["floatVar"],
                      type=float,
                      help="An example of an option to set a float variable [default: {}]".format(defaults["floatVar"])
                      )

    parser.add_argument('--stride',
                      action="store",
                      dest="stride",
                      default=defaults["stride"],
                      type=int,
                      help="An example of an option to set a int variable [default: {}]".format(defaults["stride"])
                      )

    parser.add_argument('--setStrVar',
                      action="store",
                      dest="strVar",
                      default=defaults["strVar"],
                      type=str,
                      help="An example of an option to set a str variable [default: {}]".format(defaults["strVar"])
                      )

    parser.add_argument("-v", "--verbose",
                      dest='verbosity',
                      action="count", 
                      default=0,
                      help='each occurrence increases verbosity 1 level from ERROR: -v=WARNING -vv=INFO -vvv=DEBUG')


    args = parser.parse_args()


    # Set up the logging
    console_logFormat = '%(asctime)s : (%(levelname)s):%(filename)s:%(funcName)s:%(lineno)d:  %(message)s'
    dateFormat = '%Y-%m-%d %H:%M:%S'
    levels = [logging.ERROR, logging.WARN, logging.INFO, logging.DEBUG]
    logging.basicConfig(level = levels[args.verbosity], 
            format = console_logFormat, 
            datefmt = dateFormat)


    return args


def main():
    '''
    The main method.
    '''

    options = _argparse()

    input_file = options.input_file
    optChoice  = options.optChoice
    setTrue  = options.setTrue
    floatVar = options.floatVar
    stride = options.stride
    strVar = options.strVar


    #LOG.error("This is an ERROR message.")
    #LOG.warn("This is a WARNING message.")
    #LOG.info("This is an INFO message.")
    #LOG.debug("This is a DEBUG message.")

    LOG.info("Input option 'input_file'   =  {} ".format(input_file))
    LOG.info("Input option 'optChoice'    =  {} ".format(optChoice))
    LOG.info("Input option 'setTrue'      =  {} ".format(setTrue))
    LOG.info("Input option 'floatVar'     =  {} ".format(floatVar))
    LOG.info("Input option 'stride'       =  {} ".format(stride))
    LOG.info("Input option 'strVar'       =  {} ".format(strVar))

    input_dir,input_glob = _create_input_file_globs(input_file)

    if input_glob is None :
        LOG.error("No input files found matching %s, aborting...".format(input_file))
        return 1

    LOG.info("Input directory is {}".format(input_dir))
    LOG.info("Input glob is {}".format(input_glob))

    # Get a list of input files...
    input_files = glob(path.join(input_dir,input_glob))
    input_files.sort()

    for idx in range(len(input_files)):
        input_files[idx] = path.basename(input_files[idx])

    LOG.debug(input_files)

    # Do some file operations with h5py

    fileObj = h5py.File(path.join(input_dir,input_files[0]),"r")

    dset_dicts = {}

    for dset in ['Latitude','Longitude','NDVI']:
        dset_dicts[dset] = {}
        obj = fileObj[dset]
        try:
            LOG.debug("Checking {} ...".format(dset))
            LOG.debug(obj.attrs.keys())
            LOG.debug(obj.attrs.items())
        except KeyError:
            pass
        for attr_key in obj.attrs.keys():
            dset_dicts[dset][attr_key] = obj.attrs[attr_key]

    fileObj.close()

    # Create some dictionaries
    dset_dicts['min_ndvi'] = {}
    dset_dicts['max_ndvi'] = {}

    for attr_key in dset_dicts['NDVI'].keys():
        dset_dicts['min_ndvi'][attr_key] = dset_dicts['NDVI'][attr_key]
        dset_dicts['max_ndvi'][attr_key] = dset_dicts['NDVI'][attr_key]

    for dset in dset_dicts.keys():
        LOG.debug(dset)
        for attr_key in dset_dicts[dset].keys():
            LOG.debug('\t{} = {}'.format(attr_key,dset_dicts[dset][attr_key]))

    # Create the man and max NDVI arrays


    for ndvi_file in input_files:
        LOG.debug('Opening NDVI file {}...'.format(ndvi_file))
        fileObj = h5py.File(path.join(input_dir,ndvi_file),"r")
        ndvi = fileObj['NDVI'].value[::stride,::stride]
        LOG.debug('NDVI shape is = {}'.format(ndvi.shape))

        try:
            LOG.info("Checking current NDVI against previous")
            min_idx = ndvi < prev_ndvi
            max_idx = ndvi > prev_ndvi
            min_ndvi[min_idx] = ndvi[min_idx]
            max_ndvi[max_idx] = ndvi[max_idx]
            prev_ndvi = ndvi
        except Exception, err :
            #LOG.debug(traceback.format_exc())
            LOG.info("Initialsing minimum NDVI")
            min_ndvi = copy.copy(ndvi)
            max_ndvi = copy.copy(ndvi)
            prev_ndvi = ndvi

            Latitude = fileObj['Latitude'].value[::stride]
            Longitude = fileObj['Longitude'].value[::stride]
            LOG.debug('Latitude shape is = {}'.format(Latitude.shape))
            LOG.debug('Longitude shape is = {}'.format(Longitude.shape))

        fileObj.close()

    dset_dicts['Latitude']['data'] = Latitude
    dset_dicts['Longitude']['data'] = Longitude
    dset_dicts['min_ndvi']['data'] = min_ndvi
    dset_dicts['max_ndvi']['data'] = max_ndvi

    _create_ndvi_object_h5py(input_files,dset_dicts,"min_max_ndvi_h5py.h5")

    _plot_ndvi(dset_dicts,'min_ndvi',title='Minimum Annual NDVI')
    _plot_ndvi(dset_dicts,'max_ndvi',title='Maximum Annual NDVI')

    return 0


if __name__=='__main__':
    sys.exit(main())  
